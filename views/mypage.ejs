<link rel="stylesheet" href="./css/mypage.css"/>

<div class="main-background">
  <div class="config-background container">
    <h1 style="color: black;">잔여 포인트 : <%= user.point %></h1>
    <button type="button" class="btn btn-warning mt-3" style="font-size: 30px;">이용현황</button>
    <div class="btn-end">
      <button type="button" class="btn btn-success me-3" style="font-size: 30px;">할인등록 쿠폰</button>
      
      <button type="button" class="btn btn-danger" style="font-size: 30px;">리뷰 조회</button>
    </div>
  </div>
  
  <div class="sub-background container">
    <ul class="list-group mt-2" id="user-list">
        <!-- <li class="list-group-item mb-3">
          <h5>번호 : </h5>
          <h5>지역 : </h5>
          <h5>상태 : </h5>
          <h5>서비스 시작 : </h5>
          <h5>이용 시간 : </h5>
          <button type="button" class="btn btn-primary mt-3 ms-5">리뷰 쓰기</button>
        </li> -->
    </ul>

    <nav aria-label="Page navigation example">
      <ul class="pagination">
        <li class="page-item">
          <a class="page-link" href="#" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        <li class="page-item"><a class="page-link" href="#">1</a></li>
        <li class="page-item"><a class="page-link" href="#">2</a></li>
        <li class="page-item"><a class="page-link" href="#">3</a></li>
        <li class="page-item">
          <a class="page-link" href="#" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      </ul>
    </nav>
  </div>
</div>

<script>
  $(document).ready( () => { 
    reload_comment()
  })
  const user = '<%= user %>>'
  const userId = '<%= user.userId %>'  // 서버에서 넘어온 userId, ejs문법, 스크립트 안에만 문자열
  
  // GET - 게시글 불러오기
  function reload_comment() {
    $.ajax({
      type: "GET",
      url: `/api/orders/customer/${userId}`,
      data: {},
      success: function (response) {
        doc = response['UserUseResult']
        
        $('#user-list').empty()

        for(let i = 0; i < doc.length; i++) {
          let phone = doc[i]['phone']
          let address = doc[i]['address']
          let status = doc[i]['status']
          let usageDateTimeStart = doc[i]['usageDateTimeStart']
          let usageTime = doc[i]['usageTime']

          const template = `<li class="list-group-item mb-3">
                              <h5>번호 : ${phone}</h5>
                              <h5>지역 : ${address}</h5>
                              <h5>상태 : ${status}</h5>
                              <h5>서비스 시작 : ${usageDateTimeStart}</h5>
                              <h5>이용 시간 : ${usageTime}</h5>
                              <button type="button" class="btn btn-primary mt-3 ms-5">리뷰 쓰기</button>
                            </li>`

          $('#user-list').append(template)
        }
      }
    });
  }

</script>

